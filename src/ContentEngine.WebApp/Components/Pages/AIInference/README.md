# AI推理页面组件结构

本文档说明了重构后的AI推理页面组件架构。

## 组件层次结构

```
Detail.razor (主页面)
├── TaskHeaderCard.razor (任务头部信息)
├── TaskOverviewTab.razor (任务概览标签页)
└── CombinationTableView.razor (组合表格视图)
    └── InputCombinationList.razor (输入组合列表)
```

## 组件职责

### 1. Detail.razor (主页面)
- **职责**: 页面路由、状态管理、业务逻辑协调
- **功能**: 
  - 加载实例详情
  - 处理任务执行、复制、编辑
  - 协调子组件间的交互
- **状态**: 实例数据、定义数据、加载状态、执行状态

### 2. TaskHeaderCard.razor (任务头部)
- **职责**: 显示任务基本信息和主要操作按钮
- **功能**:
  - 显示任务名称、描述、状态
  - 提供执行、复制、编辑按钮
- **输入**: Instance, Definition, IsExecuting
- **输出**: OnExecute, OnCopy, OnEdit 事件

### 3. TaskOverviewTab.razor (概览标签页)
- **职责**: 显示任务定义的详细信息
- **功能**:
  - 查询定义展示
  - 数据组合规则展示
  - Prompt模板和样例展示
  - 执行约束展示
  - 统计信息展示
- **输入**: Definition, Instance

### 4. CombinationTableView.razor (组合表格视图)
- **职责**: 管理组合数据的显示和操作
- **功能**:
  - 头部操作栏（刷新、视图切换）
  - 组合数据状态管理
  - 空状态和加载状态展示
- **输入**: Combinations, Outputs, 各种状态标志
- **输出**: 所有组合相关的事件回调

### 5. InputCombinationList.razor (组合列表)
- **职责**: 表格数据展示和批量操作
- **功能**:
  - 组合数据表格展示
  - 状态显示（待处理、已完成、失败）
  - 单个组合操作（执行、查看、重试）
  - 批量操作工具栏
- **样式**: 引用外部 CombinationStyles.css

## 重构改进点

### 1. 代码组织
- ✅ 分离关注点：UI渲染、状态管理、业务逻辑
- ✅ 提取可复用组件
- ✅ 减少代码重复

### 2. 状态管理
- ✅ 简化状态传递
- ✅ 清晰的事件回调模式
- ✅ 统一的加载和错误处理

### 3. 样式组织
- ✅ 提取外部样式文件
- ✅ 响应式设计优化
- ✅ 深色模式支持

### 4. 交互优化
- ✅ 统一的批量操作模式
- ✅ 改进的用户反馈
- ✅ 简化的事件处理

### 5. 可维护性
- ✅ 清晰的组件边界
- ✅ 类型安全的参数传递
- ✅ 一致的命名规范

## 使用指南

### 添加新功能
1. 确定功能所属的组件层级
2. 在相应组件中添加参数和事件
3. 在父组件中处理事件回调
4. 更新相关样式文件

### 修改样式
1. 组合列表相关样式 → `CombinationStyles.css`
2. 任务头部样式 → `TaskHeaderCard.razor` 内嵌样式
3. 概览页面样式 → `TaskOverviewTab.razor` 内嵌样式

### 扩展组件
- 每个组件都有清晰的输入/输出接口
- 使用 `EventCallback` 进行父子组件通信
- 遵循单一职责原则 