# ContentEngine 应用蓝图 (用户体验视角)

## 一、导航侧栏模块规划

左侧导航栏是用户访问各项核心功能的主要入口，建议包含以下模块：

1.  **首页 (Dashboard)**: 应用的起始点和概览。
2.  **数据管理 (Schema Management)**: 定义和管理数据的结构。
3.  **信息注入 (Data Entry)**: 将原始信息转化为结构化数据并存入系统。
4.  **数据洞察 (Data Explorer)**: 浏览、查询和管理已存入的结构化数据。
5.  **AI 推理坊 (AI Inference & Generation)**: (远期核心) 基于数据进行高级 AI 分析与内容生成。
6.  **引擎配置 (Settings/Configuration)**: 管理应用和 AI 服务的基础设置。
7.  **帮助中心 (Help & Documentation)**: 提供用户支持。

---

## 二、各模块功能详解

### 1. 首页 (Dashboard)

*   **目的:** 为用户提供一个快速了解系统状态和进入常用功能的入口。
*   **核心功能:**
    *   **[概览统计]:**
        *   显示关键指标：例如，已创建的 Schema 总数、数据记录总数、最近7天新增数据量。
        *   AI 服务调用情况摘要 (如果适用且希望用户可见)。
    *   **[快捷入口]:**
        *   "创建新蓝图 (Schema)" 按钮。
        *   "开始信息注入" 按钮。
        *   链接到最近使用或最重要的 Schema。
    *   **[最近活动/通知]:**
        *   列出最近创建或修改的 Schema。
        *   显示最近完成的数据注入任务。
        *   系统通知或更新提示。

### 2. 数据管理 (Schema Management)

*   **目的:** 用户在此定义数据的骨架和规则，是后续所有数据操作的基础。
*   **核心功能:**
    *   **[我的数据列表 (List Schemas)]:**
        *   **展示:** 以列表或卡片形式清晰展示所有已创建的 Schema。
        *   **信息:** 每个 Schema 应显示其名称、简要描述、字段数量、关联数据记录数、创建/修改日期。
        *   **操作:**
            *   `查看详情`: 跳转到该 Schema 的详细配置页面。
            *   `编辑`: 修改 Schema 定义。
            *   `删除`: 删除 Schema (需有警告和确认，并处理关联数据问题)。
            *   `快速入口 - 基于此 Schema 录入数据`: 直接跳转到"信息注入"模块并预选此 Schema。
            *   `(可选) 复制 Schema`: 快速创建一个基于现有 Schema 的新 Schema。
    *   **[创建新数据 (Create Schema)]:**
        *   **`选项一：手动创建`**
            *   用户逐个添加字段。
            *   为每个字段指定：字段名 (唯一)、显示名、**数据类型** (如：文本、长文本、数字、日期、布尔、单选、多选、文件、嵌套对象、列表/数组[指定元素类型])、是否必填、默认值、描述/注释。
            *   (高级) 字段校验规则 (例如，文本最大长度、数字范围)。
        *   **`选项二：AI 辅助创建 (智能建表)`**
            *   **输入:** 用户提供自然语言描述 (例如："我需要一个游戏角色的 Schema，包含姓名、种族、职业、等级、生命值、技能列表和背景故事描述")。
            *   **输入 (可选):** 用户粘贴一段样例数据 (例如：一段包含角色信息的文本片段，或几行表格数据)。
            *   **处理:** 系统调用 AI 服务分析输入，推荐 Schema 结构 (字段名、推测的数据类型)。
            *   **交互:** 用户预览 AI 推荐的 Schema，可以修改字段名、类型，增删字段，最终确认并创建。
    *   **[Schema 详情/编辑 (View/Edit Schema)]:**
        *   清晰展示选定 Schema 的所有字段及其配置。
        *   允许用户修改 Schema 定义 (添加新字段、修改现有字段属性、删除字段)。
        *   **重要提示:** 修改已有数据的 Schema 时，需要有明确的策略和用户提示 (例如，新增字段如何处理旧数据，删除字段是否会丢失数据)。

### 3. 信息注入 (Data Entry)

*   **目的:** 用户将原始的、非结构化的或半结构化的信息，通过手动或 AI 辅助的方式，转换为符合特定 Schema 的结构化数据，并存入数据库。
*   **核心功能:**
    *   **[选择目标蓝图 (Select Schema for Entry)]:**
        *   作为数据注入流程的第一步，用户必须先选择一个已经定义好的 Schema。
    *   **[逐条注入 (Manual Data Entry)]:**
        *   **表单生成:** 根据选定的 Schema 动态生成数据输入表单，每个字段对应一个合适的输入控件。
        *   **用户输入:** 用户手动填写表单中的各个字段。
        *   **校验:** 前端和后端的数据校验 (基于 Schema 中定义的必填项、类型、规则)。
        *   **保存:** 将填写好的数据保存为一条记录到对应 Schema 的数据集合中。
    *   **[智能解析注入 (AI-Assisted Data Entry)]:**
        *   **输入:** 用户选择 Schema 后，提供一段非结构化或半结构化文本 (例如，粘贴一段产品描述、会议纪要、角色传记等)。
        *   **AI 处理:** 系统调用 AI 服务，尝试根据选定 Schema 从文本中提取信息，并自动填充到数据表单的对应字段中。
        *   **预览与编辑:** 用户可以查看 AI 提取和填充的结果，进行必要的修改、补充或修正。
        *   **保存:** 确认无误后保存数据。
    *   **[批量注入 (Batch Data Entry)]:**
        *   **输入:** 用户选择 Schema 后，上传包含多条记录的文件 (例如：CSV、TXT，未来可支持 Excel、JSON Lines 等)。
        *   **AI 处理:** 系统逐条或批量处理文件中的内容，尝试根据 Schema 进行结构化解析。
        *   **预览与反馈:** 提供处理结果预览，高亮显示 AI 解析成功、可能存在问题或失败的记录。
        *   **编辑与修正 (可选):** 允许用户对解析有问题的记录进行在线修正。
        *   **批量保存:** 将成功解析和用户确认的数据批量存入数据库。
        *   **错误报告:** 对于无法处理的记录，提供下载错误报告的功能。

### 4. 数据洞察 (Data Explorer)

*   **目的:** 用户在此浏览、查询、管理和初步分析已经存储在系统中的结构化数据。
*   **核心功能:**
    *   **[选择数据集合 (Select Collection/Schema to Explore)]:**
        *   用户选择一个 Schema，以查看其下存储的所有数据记录。
    *   **[数据表视图 (Data Table View)]:**
        *   **展示:** 以表格形式清晰展示选定 Schema 的数据记录，每行一条记录，每列一个字段。
        *   **列自定义:** 允许用户选择在表格中显示哪些字段，以及调整列的顺序。
        *   **分页:** 支持大量数据的分页加载。
    *   **[记录操作 (CRUD on Records)]:**
        *   `查看详情`: 以易读的格式展示单条记录的全部信息。
        *   `编辑记录`: 允许用户修改单条记录的字段值 (动态表单)。
        *   `删除记录`: 删除单条记录 (需确认)。
        *   `(可选) 复制记录`: 快速创建一条与现有记录相似的新记录。
    *   **[筛选与排序 (Filtering & Sorting)]:**
        *   **简单筛选:** 提供基于单个或多个字段的筛选器 (例如，文本字段的"包含"、"等于"，数字字段的"大于"、"小于"、"等于"等)。
        *   **高级筛选 (可选):** 允许构建更复杂的与/或逻辑组合筛选条件。
        *   **排序:** 允许用户按任意可见字段进行升序或降序排序。
    *   **[自然语言提问 (Natural Language Query - 高级功能)]:**
        *   提供一个输入框，用户可以用自然语言描述查询需求 (例如："查找所有'类型'为'科幻'且'评分'大于8的'电影'"）。
        *   系统尝试将自然语言转换为实际的数据库查询，并返回结果。
    *   **[数据导出 (Data Export - 可选)]:**
        *   允许用户将当前筛选和排序后的数据导出为常见格式 (如 CSV, JSON)。
    *   **[基础可视化 (Basic Visualization - 高级/可选)]:**
        *   针对查询结果，提供简单的图表生成能力 (例如：柱状图展示某个分类字段的计数，饼图展示比例)。

### 5. AI 推理坊 (AI Inference & Generation)

*   **目的:** (远期核心价值) 基于已有的高质量结构化数据，利用 AI 进行更深层次的分析、洞察发现、关系推断和自动化内容生成。
*   **核心功能 (示例，具体功能需逐步迭代):**
    *   **[自定义推理任务配置]:**
        *   用户选择一个或多个输入 Schema。
        *   用户描述期望通过 AI 推理或生成的内容类型/目标 (可能通过选择预设任务或编写简单指令)。
        *   AI 执行推理并返回结果。
    *   **[内容片段生成]:**
        *   例如，选择一个"角色" Schema 和几条角色数据，AI 辅助生成这些角色之间的对话片段、互动场景描述等。
    *   **[关系发现与推断]:**
        *   例如，分析"NPC行为日志" Schema 和 "游戏事件" Schema，尝试推断哪些事件最能引发特定NPC的何种行为。
    *   **[模式识别与预测]:**
        *   例如，从大量"用户反馈"数据中识别常见问题模式或情感倾向。
    *   **[结果展示与利用]:**
        *   清晰展示 AI 推理或生成的结果。
        *   允许用户编辑、保存或导出这些结果。

### 6. 引擎配置 (Settings/Configuration)

*   **目的:** 管理应用自身和依赖服务的配置。
*   **核心功能:**
    *   **[AI 服务配置]:**
        *   安全地配置和管理连接大语言模型所需的信息 (API Keys, Endpoints, 默认模型选择等)。
        *   测试 AI 服务连接状态。
    *   **[Prompt 管理 (高级/可选)]:**
        *   如果某些核心功能的 Prompt 逻辑希望对高级用户或管理员开放调整，则在此提供管理界面 (需谨慎，不当修改可能严重影响效果)。
    *   **[数据源配置 (当前为 LiteDB，未来扩展时考虑)]:**
        *   管理数据库连接信息 (如果支持多种或可配置的数据库)。
    *   **[用户账户与权限 (如果需要多用户系统)]:**
        *   用户注册、登录、密码管理。
        *   角色与权限分配。
    *   **[系统参数设置]:**
        *   例如，默认分页大小、日期时间格式等应用级参数。

### 7. 帮助中心 (Help & Documentation)

*   **目的:** 为用户提供使用指引和问题解答。
*   **核心功能:**
    *   **[操作指南/教程]:**
        *   针对每个主要模块和核心功能提供图文并茂的使用说明。
    *   **[常见问题 (FAQ)]:**
        *   整理和回答用户在使用过程中可能遇到的常见问题。
    *   **[词汇表/概念解释]:**
        *   解释应用中涉及的一些专业术语或核心概念 (如 Schema, BsonDocument 等)。
    *   **[版本信息/关于我们]:**
        *   显示当前应用版本号、更新日志、开发团队信息等。
    *   **[联系支持/反馈渠道]:**
        *   提供用户反馈问题或寻求帮助的途径。

---

这份蓝图提供了一个相对全面的功能框架。在实际开发过程中，可以根据优先级分阶段实现，并持续根据用户反馈进行迭代和优化。希望这份蓝图对您有所帮助！

## 三、建议的 Blazor Pages 目录结构

为了配合 Blazor 项目的组织方式，并清晰地反映上述模块划分，建议在 `ContentEngine.WebApp/Components/Pages/` 目录下采用以下层级结构：

*   **`Index.razor`** (通常作为应用的默认首页，可以重定向到 Dashboard 或直接作为 Dashboard)

*   **`Dashboard/`**
    *   `Index.razor` (或 `DashboardPage.razor`) - 对应"首页 (Dashboard)"模块

*   **`SchemaManagement/`** (对应"数据管理 (Schema Management)"模块)
    *   `Index.razor` - Schema 列表页面
    *   `CreatePage.razor` - 创建新 Schema 的页面 (包含手动和 AI 辅助逻辑)
    *   `EditPage.razor` (例如，路由 `@page "/schema/edit/{SchemaId}"`) - 编辑现有 Schema 的页面
    *   `DetailsPage.razor` (例如，路由 `@page "/schema/details/{SchemaId}"`) - 查看 Schema 详情的页面 (可选，或集成到编辑页)

*   **`DataEntry/`** (对应"信息注入 (Data Entry)"模块)
    *   `Index.razor` - 数据注入引导页 (选择 Schema、选择注入方式)
    *   `ManualEntryPage.razor` (例如，路由 `@page "/data-entry/manual/{SchemaId}"`) - 手动逐条注入页面
    *   `AiAssistedEntryPage.razor` (例如，路由 `@page "/data-entry/ai/{SchemaId}"`) - AI 辅助智能解析注入页面
    *   `BatchEntryPage.razor` (例如，路由 `@page "/data-entry/batch/{SchemaId}"`) - 批量注入页面

*   **`DataExplorer/`** (对应"数据洞察 (Data Explorer)"模块)
    *   `Index.razor` (例如，路由 `@page "/explore/{SchemaName}"`) - 数据浏览与查询主页面 (显示数据表、筛选、排序)
    *   `RecordDetailsPage.razor` (例如，路由 `@page "/explore/{SchemaName}/record/{RecordId}"`) - 单条记录详情页面 (可选，或通过模态框实现)

*   **`AiInferenceLab/`** (对应"AI 推理坊 (AI Inference & Generation)"模块)
    *   `Index.razor` - AI 推理任务主页
    *   `ConfigureTaskPage.razor` - 配置自定义推理任务的页面
    *   `TaskResultsPage.razor` - 展示推理结果的页面

*   **`Settings/`** (对应"引擎配置 (Settings/Configuration)"模块)
    *   `Index.razor` - 综合设置页面
    *   `AiServiceSettingsPage.razor` - AI 服务配置子页面
    *   `UserManagementPage.razor` - 用户账户管理子页面 (如果支持多用户)
    *   `SystemParametersPage.razor` - 系统参数设置子页面

*   **`Help/`** (对应"帮助中心 (Help & Documentation)"模块)
    *   `Index.razor` - 帮助中心主页
    *   `FaqPage.razor` - 常见问题页面
    *   `TutorialsPage.razor` - 教程页面 (或包含多个子页面/组件)
    *   `GlossaryPage.razor` - 词汇表页面
    *   `AboutPage.razor` - 关于我们/版本信息页面

这种结构有助于保持代码的组织性和可维护性，每个页面组件都专注于其特定功能。路由配置将依据这些页面路径进行设置。